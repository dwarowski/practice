#  Веб-сайт для практики WebAnt

Это простой двухстраничный веб-сайт, созданный с использованием PHP, HTML и CSS. Он состоит из формы обратной связи и формы для пожертвований.

## Содержание

- [Функциональность](#функциональность)
- [Требования](#требования)
- [Установка](#установка)
- [Использование](#использование)
- [Структура файлов](#структура-файлов)
- [Зависимости](#зависимости)
- [Конфигурация](#конфигурация)
- [Валидация](#валидация)
- [Отправка электронной почты](#отправка-электронной-почты)
- [Валидация банковских карт](#валидация-банковских-карт)
- [Docker](#docker)
- [Примечания](#примечания)
- [Лицензия](#лицензия)
- [Автор](#автор)

## Функциональность

-   **Форма обратной связи (index.php):**
    -   Позволяет пользователям отправлять электронные письма с вложениями.
    -   Включает клиентскую и серверную валидацию для полей электронной почты, имени, темы и сообщения.
    -   Использует PHPMailer для отправки электронных писем через SMTP.
    -   Поддерживает загрузку файлов.
-   **Форма для пожертвований (card-form.php):**
    -   Простая форма для пожертвований с использованием банковской карты.
    -   Валидирует номер карты, CVC/CVV и дату окончания срока действия.
    -   Использует алгоритм Луна для валидации номера карты.
    -   Определяет тип карты на основе шаблонов номера карты.

## Требования

-   PHP 7.4 или выше
-   Веб-сервер Apache (или любой веб-сервер, поддерживающий PHP)
-   Библиотека PHPMailer
-   Файл `.env` с необходимой конфигурацией (см. раздел [Конфигурация](#конфигурация))

## Установка

1.  Склонируйте репозиторий в корневую папку вашего веб-сервера (например, `/var/www/html/`).
2.  Установите PHPMailer:
```bash
  composer require phpmailer/phpmailer
```

  Или вручную скачайте его из репозитория PHPMailer на GitHub (https://github.com/PHPMailer/PHPMailer) и включите его в свой проект.

3. Создайте файл .env в корневом каталоге и настройте его, как описано в разделе [Конфигурация](#конфигурация).
4. Убедитесь, что у вашего веб-сервера есть необходимые разрешения для чтения и записи файлов, особенно для загрузки файлов.

▌Использование

1. Откройте файл index.php в своем веб-браузере, чтобы получить доступ к форме обратной связи (например, http://localhost/index.php).
2. Заполните форму и отправьте ее.
3. При успешной отправке формы вы будете перенаправлены на card-form.php.
4. Откройте card-form.php в браузере, чтобы получить доступ к форме для пожертвований. Заполните форму и отправьте ее.

▌Структура файлов
```
.
├── BasicInputValidation/
│  └── class.inputValidation.php
├── ENVParser/
│  └── class.parser.php
├── PHPMailer/
│  └── src/
│    ├── Exception.php
│    ├── PHPMailer.php
│    └── SMTP.php
├── .env
├── card-form.php
├── docker-compose.yml
├── favicon.ico
├── index.php
└── README.md
```

-  index.php: Главная страница, содержащая форму обратной связи.
-  card-form.php: Вторая страница, содержащая форму для пожертвований.
-  BasicInputValidation/class.inputValidation.php: Класс для валидации входных данных.
-  ENVParser/class.parser.php: Класс для разбора переменных окружения из файла .env.
-  PHPMailer/: Содержит файлы библиотеки PHPMailer.
-  .env: Содержит переменные конфигурации для конкретной среды.
-  docker-compose.yml: Файл конфигурации для Docker Compose.
-  favicon.ico: Значок веб-сайта.
-  README.md: Этот файл.

▌Зависимости

-  PHPMailer: Для отправки электронной почты через SMTP.
-  BasicInputValidation: Пользовательский класс для валидации пользовательского ввода.
-  ENVParser: Пользовательский класс для разбора переменных .env.

▌Конфигурация

Создайте файл .env в корневом каталоге со следующей структурой:


```
Host=ваш_smtp_хост
Port=ваш_smtp_порт
Username=ваше_smtp_имя_пользователя
Password=ваш_smtp_пароль
Security=tls или ssl
```

▌Валидация

Веб-сайт использует как клиентскую (атрибуты HTML5), так и серверную (PHP) валидацию для обеспечения целостности данных. Класс BasicInputValidation используется для серверной валидации.

-  Форма обратной связи:
  -  Электронная почта: Валидирует формат электронной почты и проверяет существование домена.
  -  Имя: Проверяет на непустую строку.
  -  Тема: Проверяет на непустую строку.
  -  Сообщение: Проверяет на непустую строку.
-  Форма для пожертвований:
  -  Номер карты: Валидирует формат (числовой) и применяет алгоритм Луна.
  -  CVC/CVV: Валидирует формат (3-значное число).
  -  Дата окончания срока действия: Валидирует формат (MM/YY).

▌Отправка электронной почты

Форма обратной связи использует PHPMailer для отправки электронных писем. Функция sendEmail в index.php обрабатывает процесс отправки электронной почты. Она настраивает PHPMailer с параметрами SMTP из файла .env, устанавливает адреса отправителя и получателя, тему и текст, а также пытается отправить электронное письмо. Также поддерживаются вложения файлов.

▌Валидация банковских карт

Форма для пожертвований выполняет валидацию номера карты с использованием алгоритма Луна, реализованного в функции checkCardSum в card-form.php. Функция checkCardType использует регулярные выражения для определения типа карты на основе номера карты.

▌Docker

Файл docker-compose.yml предназначен для упрощения настройки и развертывания веб-сайта с помощью Docker.

Чтобы запустить веб-сайт с помощью Docker:

1. Убедитесь, что у вас установлен Docker и Docker Compose.
2. Перейдите в каталог проекта в своем терминале.
3. Выполните следующую команду:

  
```bash
 docker-compose up -d
 ```

  Это создаст и запустит контейнер Docker.
4. Откройте веб-сайт в своем веб-браузере по адресу http://localhost.

▌Примечания

-  Безопасность: Это простой пример, и его не следует использовать в производственной среде без надлежащих мер безопасности. Вам следует реализовать надлежащую очистку ввода, экранирование вывода и защиту от распространенных веб-уязвимостей, таких как межсайтовый скриптинг (XSS) и внедрение SQL.
-  Обработка ошибок: Предоставленный код включает базовую обработку ошибок, но вам следует реализовать более надежное ведение журнала ошибок и механизмы обратной связи с пользователем для производственной среды.
-  Загрузка файлов: Функциональность загрузки файлов должна быть тщательно защищена для предотвращения загрузки вредоносных файлов. Реализуйте проверки типов файлов, размеров и содержимого.

▌Лицензия

Этот проект является открытым исходным кодом и доступен под [лицензией MIT](LICENSE).

▌Автор

dwaru